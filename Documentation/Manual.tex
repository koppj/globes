\documentclass[a4paper,12pt,twoside]{book}

\sloppy
% \frenchspacing
\setlength{\unitlength}{1cm}

\usepackage{verbatim}
\usepackage{cite}
\usepackage[dvips]{color}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{mathrsfs}
\usepackage{a4wide}
\usepackage{fancyheadings}
\usepackage[footnotesize,bf]{caption}
\usepackage{makeidx}
%Preparations for multiple indices
\usepackage{multind}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{ae,aecompl} % only for Type 1 fonts for readable pdf convert

\newcommand{\capdef}{}
\newcommand{\mycaption}[2][\capdef]{\renewcommand{\capdef}{#2}%
        \caption[#1]{{ %\itshape
 {\footnotesize #2}}}}
\makeatletter
\renewcommand{\fnum@table}{\textbf{\tablename~\thetable}}
\renewcommand{\fnum@figure}{\textbf{\figurename~\thefigure}}
\makeatother

% Index: use "makeindex Manual" to create .ind file
%\makeindex

\makeindex{norm}
\makeindex{constants}
\makeindex{api}
\makeindex{aedl}

\newcommand{\bi}{\begin{itemize}}
\newcommand{\ei}{\end{itemize}}
\newcommand{\ra}{$\rightarrow$}
\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}
\newcommand{\bea}{\begin{eqnarray}}
\newcommand{\eea}{\end{eqnarray}}
\newcommand{\nn}{\nonumber}
\newcommand{\ldm}{\Delta m_{31}^2}
\newcommand{\sdm}{\Delta m_{21}^2}
\newcommand{\deltacp}{\delta_{\mathrm{CP}}}
\newcommand{\stheta}{\sin^2 2 \theta_{13}}

\newcommand{\ie}{{\it i.e.}}
\newcommand{\Ie}{{\it I.e.}}
\newcommand{\eg}{{\it e.g.}}
\newcommand{\Eg}{{\it E.g.}}
\newcommand{\cf}{{\it cf.}}
\newcommand{\etc}{{\it etc.}}
\newcommand{\eq}{Eq.}
\newcommand{\eqs}{Eqs.}
\newcommand{\Def}{Definition}
\newcommand{\fig}{Fig.}
\newcommand{\Fig}{Fig.}
\newcommand{\figs}{Figs.}
\newcommand{\Figs}{Figs.}
\newcommand{\Ref}{Ref.}
\newcommand{\Refs}{Refs.}
\newcommand{\Sec}{Sec.}
\newcommand{\Secs}{Secs.}
\newcommand{\Chapt}{Chapter}
\newcommand{\Chapts}{Chapters}
\newcommand{\Part}{Part}
\newcommand{\App}{Appendix}
\newcommand{\Apps}{Appendices}
\newcommand{\Tab}{Table}
\newcommand{\Tabs}{Tables}

\newcommand{\JHFSK}{{\sc JHF-SK}}
\newcommand{\NUMI }{{\sc NuMI}}
\newcommand{\ReactorI}{{\sc Reactor-I}}
\newcommand{\ReactorII}{{\sc Reactor-II}}
\newcommand{\JHFHK}{{\sc JHF-HK}}
\newcommand{\NuFactI}{{\sc NuFact-I}}
\newcommand{\NuFactII}{{\sc NuFact-II}}
\newcommand{\SPL}{{\sc SPL}}
\newcommand{\Beta}{{\sc $\beta$-Beam}}

\newcommand{\GLOBES}{{\sf GLoBES}}
\newcommand{\AEDL}{{\sf AEDL}}
\newcommand{\EDM}{{\sf EDM}}

\newcommand{\equ}[1]{\eq~(\ref{equ:#1})}
\newcommand{\figu}[1]{\fig~\ref{fig:#1}}
\newcommand{\tabl}[1]{\Tab~\ref{tab:#1}}
\newcommand{\tb}{\hspace*{3ex}}

% Set as GLoBES command and add to index:
% Always use GLB when mentioning a command in text!
\newcommand{\GLB}[1]{{\tt glb#1}\index{api}{#1@{\tt #1}}}
% Always use GLBNS when adding a command to the index without showing it!
\newcommand{\GLBNS}[1]{\index{api}{#1@{\tt #1}}}

% Set as GLoBES command and add to index:
% Always use GLB when mentioning a command in text!
\newcommand{\GLBC}[1]{{\tt #1}\index{constants}{\tt{#1}}}
% Always use GLBNS when adding a command to the index without showing it!
\newcommand{\GLBNSC}[1]{\index{constants}{{\tt #1}}}
\newcommand{\gq}[1]{\begin{quote} {\tt #1} \end{quote}}
\newcommand{\go}[1]{$\rightarrow$ Output: \begin{quote} {\sf #1} \end{quote}}
\newcommand{\bugs}{{\tt globes@ph.tum.de}}
\definecolor{light}{gray}{0.93}
\definecolor{heavy}{gray}{0.35}
\setlength{\fboxrule}{0.1cm}
\newcommand{\example}[2]{
\begin{table}[p]
\begin{center}
\fcolorbox{heavy}{light}{
\begin{minipage}[t][\textheight][t]{15.5cm}
{\em \underline{Example:} #1}

\vspace*{0.3cm}

#2

\end{minipage}
}
\end{center}
\end{table}
}


\newtheorem{function}{Function}[chapter]

%-- page parameters -------------------------------------------------

\pagestyle{fancyplain}

% Olddefs:

%\addtolength{\textwidth}{-1truecm}
%\addtolength{\oddsidemargin}{1.0truecm}
%\addtolength{\evensidemargin}{-0.3truecm}

% Owndefs:

%\addtolength{\textwidth}{0.0truecm}
%\addtolength{\textheight}{1.8truecm}
%\addtolength{\topmargin}{-0.6truecm}
%\addtolength{\oddsidemargin}{0.65truecm}
%\addtolength{\evensidemargin}{-1.0truecm}

% Headdefs:

\advance \headheight by 3.0truept       % for 12pt mandatory...
\lhead[\fancyplain{}{\thepage}]{\fancyplain{}{\rightmark}}
\rhead[\fancyplain{}{\leftmark}]{\fancyplain{\thepage}{\thepage}}
\cfoot{}

\renewcommand{\chaptermark}[1]{
% chapter title im Seitenkopf
\markboth{\uppercase{\chaptername}\ \thechapter.\ \ #1}
          {\uppercase{\chaptername}\ \thechapter.\ \ #1}}
% section title im Seitenkopf
\renewcommand{\sectionmark}[1]{\markright{\thesection\ \ #1}}




\begin{document} 

\frontmatter
\pagenumbering{Roman}
\thispagestyle{empty}
{
\setlength{\parindent}{0cm}

%\begin{titlepage}

\font\fa=cmssbx14 scaled 1440
\font\fb=cmbx10 scaled 1200
\font\fc=cmb10 scaled 1200
\font\fd=cmr10 scaled 1000  

{\setlength{\baselineskip}{1.2cm}}

\input{tumlogo}

\begin{minipage}{7cm}
\begin{center}
{\bf Technische Universit{\"a}t M{\"u}nchen} \\
Physik-Department \\
Institut f{\"u}r Theoretische Physik, T30d \\
\end{center}
\end{minipage}

\vspace{-2cm}

\hfill \oTUM{3.5cm}

\vspace{3cm}

\begin{center}
{ \Large \bf
\GLOBES\ 1.X \\
General Long Baseline Experiment Simulator \\ }
\vspace*{0.5cm}
{\large \bf User's and experiment definition manual }

%\vspace*{1.5cm}
%{\large \bf !!!DRAFT IN PROGRESS!!! }
\end{center}

\vspace{1cm}

\begin{center}
{\large Patrick Huber, Manfred Lindner, Walter Winter}
\end{center}

\vspace{1cm}

\begin{center}
\colorbox{black}{\includegraphics[width=7cm]{earthint}}

\vspace*{-1cm}

{\Huge \textcolor{yellow}{GLoBES}}
\end{center}

\vspace{1cm}

\begin{center}
Version from \today
\end{center}

%\end{titlepage}

%\title{}
%\date{}
%\author{}
%\maketitle

}


\clearpage
\thispagestyle{empty}
\bigskip
\begin{quote}
    Copyright \copyright  2004  The GLoBES Team.
    Permission is granted to copy, distribute and/or modify this document
    under the terms of the GNU Free Documentation License, Version 1.2
    or any later version published by the Free Software Foundation;
    with the invariant Sections ``Terms of usage of \GLOBES" 
    and ``Acknowledgments'', no Front-Cover Texts, and no Back-Cover Texts.
    A copy of the license is included in the section entitled "GNU
    Free Documentation License".
\end{quote}
\bigskip
    


\cleardoublepage
\setcounter{page}{1}

\chapter*{What is \GLOBES ?}

\GLOBES\ (``General Long Baseline Experiment Simulator'') is a flexible
software package to simulate neutrino oscillation 
long baseline and reactor experiments. On the
one hand, it contains a comprehensive abstract experiment definition
language (AEDL), which allows to describe most classes 
of long baseline experiments
at an abstract level. On the other hand, it provides a C-library to 
process the experiment information in order to obtain oscillation
probabilities, rate vectors, and $\Delta \chi^2$-values. Currently, 
\GLOBES\ is available for GNU/Linux. Since the source code is included,
the port to other operating systems is in principle possible.

\GLOBES\ allows to simulate experiments with stationary neutrino point sources, where each experiment is assumed to have only one neutrino source.
Such experiments are neutrino beam experiments and reactor experiments. 
Geometrical effects of a source distribution, such as in the sun or the 
atmosphere, can not be described. In addition, sources with a physically 
significant time dependencies  can not be studied, such as  supernov\ae. It 
is, however, possible to simulate beams with bunch structure, since the 
time dependence of the neutrino source is physically only important to suppress backgrounds. 

On the experiment definition side, either built-in neutrino fluxes
(\eg, neutrino factory) or arbitrary fluxes can be used. Similarly,
arbitrary cross sections, energy dependent efficiencies, the
energy resolution function, the considered oscillation channels, 
backgrounds, and many other features can be specified. 
For the systematics, energy
normalization and calibration errors can be simulated. Note that
the energy ranges and windows, as well as the bin widths can be
(almost) arbitrarily chosen, which means that variable bin
widths are allowed. Together with \GLOBES\ comes a number of
pre-defined experiments in order to demonstrate the capabilities
of \GLOBES\ and to provide prototypes for new experiments.

With the C-library, one can extract the $\Delta \chi^2$ for all defined 
oscillation channels for an experiment or any combination of experiments.
Of course, also low-level information, such as oscillation
probabilities or event rates, can be obtained. \GLOBES\ includes the
simulation of neutrino oscillations in matter with arbitrary matter 
density profiles, as well as it allows to simulate the matter density
uncertainty. As one of the most
advanced features of \GLOBES , it provides the technology to 
project the $\Delta \chi^2$, which is a function of all oscillation
parameters, onto any subspace of parameters by local minimization. 
This approach allows the inclusion of multi-parameter-correlations,
where external input (\eg, from solar parameters) can be imposed, too.
Applications of the projection mechanism include the projections onto the $\stheta$-axis and the $\stheta$-$\deltacp$-plane. In addition, all oscillation parameters can be kept free to precisely localize 
degenerate solutions.

\chapter*{Terms of usage of \GLOBES}

\GLOBES\ is mainly developed for academic use. Thus The \GLOBES\ Team would
appreciate being given academic credit for it. Whenever you use \GLOBES\
to produce a publication or a talk indicate that you have used \GLOBES\ and
please cite the following reference
\begin{quote}
P. Huber, M. Lindner and W. Winter ... 
\end{quote}
and \emph{not} this manual. This manual does not constitute a scientific 
publication and will not be submitted to any scientific journal. 
It will evolve during time since it is intendend for 
regular revision.
Besides, many of the data which is used by \GLOBES\ and distributed together
with it should be correctly referenced where possible. For details see the
???.

Apart from that, \GLOBES\ is free software and open source, as such it is 
licensed under the GNU Public License.

\cleardoublepage
\tableofcontents

\cleardoublepage
\setcounter{page}{1}
\pagenumbering{arabic}

\chapter*{How to use this manual}
\addcontentsline{toc}{chapter}{How to use this manual}

As it is illustrated in \figu{GLOBES}, \GLOBES\ consists 
of several modules.
%
\begin{figure}[bht]
\begin{center}
\includegraphics[width=16cm]{GLOBES}
\end{center}
\caption{\label{fig:GLOBES} Different modules in \GLOBES .}
\end{figure}
%
\AEDL (``Abstract Experiment Definition Language'') is a language
to define experiments in form of ordinary text files. One or more of 
the resulting \AEDL\ files can then be processed together with supporting 
flux or cross section files by the user interface. The user interface
is a C-library, which loads one or more \AEDL\ file(s)
containing the experiment definition(s). The user interface is linked 
against the application software, and provides the user interface functions
for the intended experiment simulation. 

The application 
software is, except from some example files, not part of \GLOBES , since
the evaluation of the experiment performance is often a matter of taste
and definition. In addition, the algorithms depend, especially for
high-precision instruments, very much on the oscillation parameters.
In general, it is quite simple to simulate superbeams and reactor
experiments. However, because of the more complicated topology, the
simulation of neutrino factories is much more difficult. In order
to demonstrate some of these difficulties, we present in this manual only
examples with neutrino factories. These examples can be found in
\Part~\ref{part:1} within the boxed pages. As complete files, they
are also available in the \GLOBES\ software package.

The \GLOBES\ software may have two target groups: 
Physicists, who are mainly interested in optimizing the potential
of specific experimental setups, and others, who are mainly
interested in the physics potential of different experiment types
from a theoretical point of view.
For the first group, \AEDL\ could be the most interesting aspect of
\GLOBES , where the user interface is only a tool to obtain specific
parameter sensitivities. In this case, \GLOBES\ could, serve as a
unified tool for the comparison and optimization of different experiment
 setups on equal footing, where
it is the primary objective to simulate the experiments as accurate
as possible. In addition, changes in experimental parameters, such as
efficiencies or the energy resolutions, can quickly be tested.
%
For the second user group, the pre-defined 
experiment definition files might already be sufficient to test
new conceptual approaches, and the user interface is the most interesting
aspect for sophisticated applications including correlations,
degeneracies, and multi-experiment setups. In either case, the \GLOBES\
software could serve as a platform for the exchange of experiment
definitions, and for an efficient splitting of work between
experimentalists and theorists.

The user interface functions are described in \Part~\ref{part:1} of 
this manual, which is the ``user's manual''. In there, first of all a 
short \GLOBES\ tour is given in \Chapt~\ref{chapter:tour} in order to 
have an overview over \GLOBES . 
After that, the user
interface is successively introduced from very basic to more sophisticated
functions. Eventually, it is demonstrated how one can change many
experiment parameters at running time (such as baseline or target mass), and how one can obtain low-level
information. We recommend that everybody interested in \GLOBES\ should
become familiar at least with the concepts in \Chapt~\ref{chapter:tour}
 and some of the examples on the boxed pages. The examples can be 
 directly compiled 
 from the respective directory in the \GLOBES\ software package.

In \Part~\ref{part:2} of the manual, \AEDL\ is described. After an
introductory chapter, all functions are defined in greater detail.
This part might be more interesting for the experimental users who
want to modify or create \AEDL\ files. A useful tool in this context
is the software program \verb+globes+, which returns event rates and other
information for individual \AEDL\ files without further programming. 
For example, flux normalizations can with this tool be easily adjusted 
to reproduce the event rates of a specific experiment. It is described
in the last chapter of \Part~\ref{part:2}.


\paragraph{Note:} All examples for application software in C do require
a C++ compiler to be properly compiled. For pedagogical reasons, variable
declarations are done at that place where the variable is needed for the
first time, which is at variance with C syntax but not with C++ syntax.
That is the only way in which the examples deviate form ISO C. 

%Finally, \Part~\ref{part:3} of this manual serves as reference manual,
%and the appendix contains further supplementary information.



\mainmatter
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PART I: User's manual
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{part1}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PART II: Experiment definition module
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{part2}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PART III: Reference manual
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \input{part3}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Appendix
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\backmatter
\chapter*{Acknowledgments}
\addcontentsline{toc}{chapter}{Acknowledgments}

We would like to thank Martin Freund, who wrote the very first
version of a three-flavour matter profile treatment many years ago.
PH is especially thankful for the invaluable advice of Thomas Fischbacher on
many design issues. 
In addition, we would like to thank
Mark Rolinec for his help to translate the experiment descriptions
into \AEDL , and for creating the illustrations in this manuscript.
Finally, thanks to all the people who have been pushing this project
for many years, to the ones who have been continuing asking for the 
publication of the software, and the referees of several of our
papers for suggestions which lead to improvements in the software.


\input{appendix}

% Bibliography:

\bibliographystyle{./unsrt}
\bibliography{references}

% Index:

\chapter{Indices}
\printindex{api}{API functions}

\printindex{constants}{API constants \& macros}

\printindex{aedl}{AEDL reference}

\printindex{norm}{Index}

\end{document}
